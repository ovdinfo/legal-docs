!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("substance")):"function"==typeof define&&define.amd?define(["substance"],e):e(t.window.substance)}(this,function(t){"use strict";var e=t.ProseEditorPackage.ProseEditor,o=function(e){function o(){e.apply(this,arguments)}return e&&(o.__proto__=e),o.prototype=Object.create(e&&e.prototype),o.prototype.constructor=o,o.prototype.didMount=function(){var t=this.context.scrollPane,e=this.componentRegistry.get("overlay"),o=this.componentRegistry.get("dropzones");this.overlay=new e(this,{toolGroups:["annotations","text","overlay"]}).mount(t.el),this.dropzones=new o(this,{}).mount(t.el)},o.prototype.dispose=function(){this.overlay.remove(),this.dropzones.remove()},o.prototype.render=function(e){var o=e("div").addClass("sc-rich-text-area-editor"),n=this.getConfigurator();return o.append(e(t.ContainerEditor,{disabled:this.props.disabled,editorSession:this.editorSession,node:this.doc.get("body"),commands:n.getSurfaceCommandNames(),textTypes:n.getTextTypes()}).ref("body")),o},o}(e),n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.convertDocument=function(t){var e=t.find("body");this.convertContainer(e.childNodes,"body")},e}(t.HTMLImporter),r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.convertDocument=function(t){var e=t.get("body"),o=this.convertContainer(e);return o.map(function(t){return t.outerHTML}).join("")},e}(t.HTMLExporter),i={name:"rich-text-area",configure:function(e){e.defineSchema({name:"rich-text-area",DocumentClass:t.Document,defaultTextType:"paragraph"});var o={disableCollapsedCursor:!0,toolGroup:"overlay"};e["import"](t.BasePackage,o),e["import"](t.ParagraphPackage,o),e.addImporter("html",n),e.addExporter("html",r)}},a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.PropertyAnnotation);a.define({type:"xref",content:{type:"string",optional:!0}}),a.fragmentation=t.Fragmenter.SHOULD_NOT_SPLIT;var s={type:"xref",tagName:"span",matchElement:function(t){return t.is("span")&&"xref"===t.attr("data-type")}},p={name:"xref",configure:function(e,o){var n=o.toolGroup,r=o.disableCollapsedCursor;e.addNode(a),e.addComponent("xref",t.AnnotationComponent),e.addConverter("html",s),e.addCommand("xref",t.AnnotationCommand,{nodeType:"xref",disableCollapsedCursor:r}),e.addTool("xref",t.AnnotationTool,{toolGroup:n||"annotations"}),e.addIcon("xref",{fontawesome:"fa-comment"}),e.addLabel("xref","Comment")}},d=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this,o=this.getComponent("button"),n=t("div").addClass("sc-minimal-switch-text-type");return this.props.textTypes.forEach(function(r){var i=t(o,{label:r.name,active:e.props.currentTextType.name===r.name,disabled:e.props.disabled,style:e.props.style}).attr("data-type",r.name).on("click",e.handleClick);n.append(i)}),n},e.prototype.handleClick=function(t){var e=t.currentTarget.dataset.type;t.preventDefault(),this.context.commandManager.executeCommand(this.getCommandName(),{textType:e})},e}(t.Tool),c=t.SwitchTextTypePackage.SwitchTextTypeCommand,l={name:"minimal-switch-text-type",configure:function(t){t.addToolGroup("text"),t.addCommand("minimal-switch-text-type",c,{disableCollapsedCursor:!0}),t.addTool("minimal-switch-text-type",d,{toolGroup:"text"}),t.addLabel("paragraph","P"),t.addLabel("heading1","H1"),t.addLabel("heading2","H2"),t.addLabel("heading3","H3")}},u={strong:t.StrongPackage,emphasis:t.EmphasisPackage,link:t.LinkPackage,list:t.ListPackage,table:t.TablePackage,xref:p,heading:t.HeadingPackage,"text-align":t.TextAlignPackage},h=["heading","strong","emphasis","link","list","table"],m=function(e){function n(){for(var o=this,n=[],r=arguments.length;r--;)n[r]=arguments[r];e.apply(this,n),this.cfg=(new t.Configurator)["import"](i);var a=this.props.config.enabledPackages||h,s={disableCollapsedCursor:!0,toolGroup:"annotations"};a.forEach(function(t){o.cfg["import"](u[t],s)}),a.indexOf("heading")>=0&&this.cfg["import"](l),this._initDoc(this.props)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.didMount=function(){this.registerHandlers()},n.prototype.didUpdate=function(){this.registerHandlers()},n.prototype.hideOverlays=function(){this.refs.editor.hideOverlays()},n.prototype.registerHandlers=function(){this.editorSession.onRender("selection",this._onSelectionChanged,this)},n.prototype.unregisterHandlers=function(){this.editorSession.off(this)},n.prototype.dispose=function(){this.unregisterHandlers()},n.prototype.blur=function(){this.editorSession.setSelection(null)},n.prototype._onSelectionPositioned=function(t){t.editorId=this.props.editorId,this.emit("selection:positioned",t)},n.prototype.getChildContext=function(){return{editorId:this.props.editorId,scrollPane:this.props.scrollPane}},n.prototype.willReceiveProps=function(t){this.dispose(),this.empty(),this._initDoc(t)},n.prototype._initDoc=function(e){this.importer=this.cfg.createImporter("html"),this.doc=this.importer.importDocument(e.html),this.editorSession=new t.EditorSession(this.doc,{id:this.props.editorId,configurator:this.cfg})},n.prototype._onSelectionChanged=function(){var t=this.editorSession.getSelectionState(),e=t.getAnnotationsForType("xref")[0];this.emit("selection:changed",{activeAnnotation:e,editorId:this.props.editorId})},n.prototype.render=function(t){var e=t("div").addClass("sc-rich-text-area");return e.append(t(o,{editorSession:this.editorSession,editorId:this.props.editorId}).ref("editor")),e},n.prototype.getHTML=function(){var t=this.cfg.createExporter("html");return t.exportDocument(this.doc)},n}(t.Component),f=t.BodyScrollPanePackage.BodyScrollPane,y=function(e){function o(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];e.apply(this,t),this._editables={},this.bodyScrollPane=f.mount({},document.body),this.bodyScrollPane.on("selection:positioned",this._onSelectionPositioned,this)}return e&&(o.__proto__=e),o.prototype=Object.create(e&&e.prototype),o.prototype.constructor=o,o.prototype.dispose=function(){this.bodyScrollPane.off(this)},o.prototype.addRichTextArea=function(e,o,n){n=n||{},o=t.DefaultDOMElement.wrapNativeElement(o);var r=o.innerHTML;o.innerHTML="";var i=m.mount({scrollPane:this.bodyScrollPane,editorId:e,html:r,config:n},o);return i.on("selection:positioned",this._onSelectionPositioned,this),i.on("selection:changed",this._onSelectionChanged,this),this._editables[e]=i,i},o.prototype._onSelectionPositioned=function(t){this.emit("selection:positioned",t)},o.prototype._onSelectionChanged=function(t){this.emit("selection:changed",t)},o.prototype.removeRichTextArea=function(t){this._editables[t].off(this)},o.prototype.getHTML=function(t){return this._editables[t].getHTML()},o.prototype.setHTML=function(t,e){var o=this._editables[t];o.extendProps({html:e})},o}(t.EventEmitter);window.SubstanceForms=y});
//# sourceMappingURL=/Users/michael/projects/substance/forms/dist/substance-forms.min.js.map